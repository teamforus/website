!function(s,t,i,r){"use strict";var h="JStick",c={context:t,dockBottom:!0,offsetTop:0,offsetBottom:0};function e(t,e){var o,n;this.element=t,this.settings=s.extend({},c,e),this._defaults=c,this._name=h,this.settings.parent=this.element.parentElement,this.settings.vendorTransform=(o=i.createElement("div"),n=o.style.transform!=r?"transform":o.style.webkitTransform!=r?"webkitTransform":o.style.mozTransform!=r?"mozTransform":o.style.msTransform!=r&&"msTransform",o.remove(),n),this.ticking=!1,this.elGeom=this.getGeomInDocument(this.element),this.parentGeom=this.getGeomInDocument(this.settings.parent),this.dockedTop=!1,this.dockedBottom=!1,this.timer=0,this.transY=0,this.init()}s.extend(e.prototype,{init:function(){var t,e;console.log("init",this.settings),s(this.settings.context).on("scroll",(t=this,e="onScroll",function(){return t[e].apply(t,arguments)}))},getPosInViewport:function(t){return(t||this.element).getBoundingClientRect()},getGeomInDocument:function(t){var e=this.getPosInViewport(t),o=this.getScrollOffsets();return{x:e.left+o.x,y:e.top+o.y,w:e.width||e.right-e.left,h:e.height||e.bottom-e.top}},getScrollOffsets:function(t){return{x:(t=this.settings.context).pageXOffset,y:t.pageYOffset}},getViewportSize:function(t){return{w:(t=this.settings.context).innerWidth,h:t.innerHeight}},dockTop:function(){this.dockedTop=!0,s(this.element).trigger(h+":dockTop")},undockTop:function(){this.dockedTop=!1,s(this.element).trigger(h+":undockTop")},dockBottom:function(){this.dockedBottom=!0,s(this.element).trigger(h+":dockBottom")},undockBottom:function(){this.dockedBottom=!1,s(this.element).trigger(h+":undockBottom")},onScroll:function(){if(!this.ticking){var t=this;t.ticking=!0,console.log("scroll tick"),requestAnimationFrame(function(){!function t(e){e.transY=e.getScrollOffsets().y-e.elGeom.y+e.settings.offsetTop,e.getScrollOffsets().y>=e.elGeom.y-e.settings.offsetTop?e.dockedTop||e.dockTop():(e.transY=0,e.dockedTop&&e.undockTop()),e.elGeom.y+e.elGeom.h+e.transY>=e.parentGeom.y+e.parentGeom.h?(e.transY=e.parentGeom.y+e.parentGeom.h-(e.elGeom.y+e.elGeom.h),e.dockedBottom||(e.dockBottom(),console.log("new dockbottom"))):e.dockedBottom&&e.undockBottom(),e.element.style[e.settings.vendorTransform]="translateY("+e.transY+"px)",e.ticking&&requestAnimationFrame(function(){t(e)})}(t)})}clearTimeout(this.timer),this.timer=setTimeout(function(){this.ticking=!1,console.log("timeout")},300)},loop:function(){this.transY=this.getScrollOffsets().y-this.elGeom.y+this.settings.offsetTop,this.getScrollOffsets().y>=this.elGeom.y-this.settings.offsetTop?this.dockedTop||this.dockTop():(this.transY=0,this.dockedTop&&this.undockTop()),this.elGeom.y+this.elGeom.h+this.transY>=this.parentGeom.y+this.parentGeom.h?(this.transY=this.parentGeom.y+this.parentGeom.h-(this.elGeom.y+this.elGeom.h),this.dockedBottom||(this.dockBottom(),console.log("new dockbottom"))):this.dockedBottom&&this.undockBottom(),this.element.style[this.settings.vendorTransform]="translateY("+this.transY+"px)"},destroy:function(){}}),s.fn[h]=function(t){return this.each(function(){s.data(this,"plugin_"+h)||s.data(this,"plugin_"+h,new e(this,t))})}}(jQuery,window,document);